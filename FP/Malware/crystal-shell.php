<?php

error_reporting(0);

$dir = realpath("./") . "/";
$dir = str_replace("\\", "/", $dir);

function listFiles($directory) {
    $items = scandir($directory);
    echo "<h3>Directory Listing: " . htmlentities($directory) . "</h3>";
    echo "<ul>";
    foreach ($items as $item) {
        if ($item !== "." && $item !== "..") {
            echo "<li>" . htmlentities($item) . "</li>";
        }
    }
    echo "</ul>";
}

function viewFile($file) {
    if (file_exists($file) && is_readable($file)) {
        echo "<h3>Viewing File: " . htmlentities(basename($file)) . "</h3>";
        echo "<pre>" . htmlentities(file_get_contents($file)) . "</pre>";
    } else {
        echo "<p>Error: File not found or unreadable.</p>";
    }
}

$viewFile = isset($_GET['view']) ? realpath($_GET['view']) : "";

if ($viewFile && strpos($viewFile, realpath("./")) === 0) {
    viewFile($viewFile);
} else {
    listFiles(realpath("./"));
}

?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safe File Manager</title>
    <style>
        body { background-color: #111; color: #1CB081; font-family: Arial, sans-serif; text-align: center; }
        h3 { color: #FFD700; }
        ul { list-style: none; padding: 0; }
        li { margin: 5px 0; }
    </style>
</head>
<body>
    <h1>Safe Code</h1>
</body>
</html>
