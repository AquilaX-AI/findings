<?php
session_start();

const ADMIN_USER = 'admin';
const ADMIN_PASS = 'password';

function login($username, $password) {
    if ($username === ADMIN_USER && password_verify($password, password_hash(ADMIN_PASS, PASSWORD_DEFAULT))) {
        $_SESSION['authenticated'] = true;
        return true;
    }
    return false;
}

function logout() {
    session_destroy();
    header("Location: login.php");
    exit;
}

function isAuthenticated() {
    return !empty($_SESSION['authenticated']);
}

function sanitize_input($data) {
    return htmlspecialchars(trim($data), ENT_QUOTES, 'UTF-8');
}

if (!isset($_SESSION['authenticated'])) {
    header("HTTP/1.1 403 Forbidden");
    exit("Access Denied");
}

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $action = filter_input(INPUT_POST, 'action', FILTER_SANITIZE_STRING);
    
    switch ($action) {
        case 'logout':
            logout();
            break;
        default:
            http_response_code(400);
            echo "Invalid action";
            break;
    }
} else {
    echo "<h2>Welcome </h2>";
    echo "<form method='POST'><button name='action' value='logout'>Logout</button></form>";
}
?>
