<?php

session_start();

// Authentication - Change this to a strong password
$admin_password = 'YourStrongPasswordHere';
if (!isset($_SESSION['auth']) || $_SESSION['auth'] !== true) {
    if (isset($_POST['password']) && $_POST['password'] === $admin_password) {
        $_SESSION['auth'] = true;
        header("Location: " . $_SERVER['PHP_SELF']);
        exit;
    }
    echo '<form method="post"><input type="password" name="password" placeholder="Enter Password" required><input type="submit" value="Login"></form>';
    exit;
}

// File Upload
if (isset($_FILES['file'])) {
    $upload_dir = __DIR__ . '/uploads/';
    if (!is_dir($upload_dir)) {
        mkdir($upload_dir, 0755, true);
    }
    $file_path = $upload_dir . basename($_FILES['file']['name']);
    if (move_uploaded_file($_FILES['file']['tmp_name'], $file_path)) {
        echo "File uploaded successfully.";
    } else {
        echo "Upload failed.";
    }
}

$files = scandir(__DIR__ . '/uploads/');
$files = array_diff($files, array('.', '..'));

echo '<h2>File Manager</h2>';
echo '<ul>';
foreach ($files as $file) {
    echo '<li><a href="uploads/' . htmlspecialchars($file) . '" download>' . htmlspecialchars($file) . '</a></li>';
}
echo '</ul>';

echo '<form method="post" enctype="multipart/form-data">';
echo '<input type="file" name="file" required>'; 
echo '<input type="submit" value="Upload">';
echo '</form>';

// Logout
if (isset($_GET['logout'])) {
    session_destroy();
    header("Location: " . $_SERVER['PHP_SELF']);
    exit;
}
echo '<br><a href="?logout">Logout</a>';

?>
